<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ABC Basic · GpABC</title><link rel="canonical" href="https://tanhevg.github.io/GpABC.jl/stable/ref-abc/index.html"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>GpABC</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../notation/">Notation</a></li><li><span class="toctext">Package Overview</span><ul><li><a class="toctext" href="../overview-abc/">ABC Parameter Inference</a></li><li><a class="toctext" href="../overview-ms/">ABC Model Selection</a></li><li><a class="toctext" href="../overview-lna/">LNA</a></li><li><a class="toctext" href="../overview-gp/">Gaussian Process Regression</a></li><li><a class="toctext" href="../summary_stats/">Summary Statistics</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../example-abc/">ABC Parameter Inference</a></li><li><a class="toctext" href="../example-ms/">ABC Model Selection</a></li><li><a class="toctext" href="../example-lna/">LNA</a></li><li><a class="toctext" href="../example-gp/">Gaussian Processes</a></li></ul></li><li><span class="toctext">Reference</span><ul><li class="current"><a class="toctext" href>ABC Basic</a><ul class="internal"><li><a class="toctext" href="#Index-1">Index</a></li><li><a class="toctext" href="#Types-and-Functions-1">Types and Functions</a></li></ul></li><li><a class="toctext" href="../ref-abc-advanced/">ABC Advanced</a></li><li><a class="toctext" href="../ref-lna/">LNA</a></li><li><a class="toctext" href="../ref-ms/">Model Selection</a></li><li><a class="toctext" href="../ref-gp/">Gaussian Processes</a></li><li><a class="toctext" href="../ref-kernels/">Kernels</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Reference</li><li><a href>ABC Basic</a></li></ul><a class="edit-page" href="https://github.com/tanhevg/GpABC.jl/blob/master/docs/src/ref-abc.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>ABC Basic</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="ABC-Basic-Reference-1" href="#ABC-Basic-Reference-1">ABC Basic Reference</a></h1><p><code>GpABC</code> functions for parameter estimation with Approximate Bayesian Computation. See also <a href="../example-abc/#ABC-Example-1">ABC Example</a>.</p><h2><a class="nav-anchor" id="Index-1" href="#Index-1">Index</a></h2><ul><li><a href="#GpABC.ABCRejectionOutput"><code>GpABC.ABCRejectionOutput</code></a></li><li><a href="#GpABC.ABCSMCOutput"><code>GpABC.ABCSMCOutput</code></a></li><li><a href="#GpABC.EmulatedABCRejection"><code>GpABC.EmulatedABCRejection</code></a></li><li><a href="#GpABC.EmulatedABCSMC"><code>GpABC.EmulatedABCSMC</code></a></li><li><a href="#GpABC.SimulatedABCRejection"><code>GpABC.SimulatedABCRejection</code></a></li><li><a href="#GpABC.SimulatedABCSMC"><code>GpABC.SimulatedABCSMC</code></a></li></ul><h2><a class="nav-anchor" id="Types-and-Functions-1" href="#Types-and-Functions-1">Types and Functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.ABCRejectionOutput" href="#GpABC.ABCRejectionOutput"><code>GpABC.ABCRejectionOutput</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">ABCRejectionOutput</code></pre><p>A container for the output of a rejection-ABC computation.</p><p><strong>Fields</strong></p><ul><li><code>n_params::Int64</code>: The number of parameters to be estimated.</li><li><code>n_accepted::Int64</code>: The number of accepted parameter vectors (particles) in the posterior.</li><li><code>n_tries::Int64</code>: The total number of parameter vectors (particles) that were tried.</li><li><code>threshold::Float64</code>: The maximum distance from the summarised model output to summarised observed data for a parameter vector to be included in the posterior.</li><li><code>population::AbstractArray{Float64,2}</code>: The parameter vectors (particles) in the posterior. Size: (<code>n_accepted</code>, <code>n_params</code>).</li><li><code>distances::AbstractArray{Float64,1}</code>: The distances for each parameter vector (particle) in the posterior to the observed data in summary statistic space. Size: (<code>n_accepted</code>).</li><li><code>weights::StatsBase.Weights</code>: The weight of each parameter vector (particle) in the posterior.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/cadb9b1454bb34fe670c90d263bba63a52f1ec93/src/abc/io.jl#L243-L256">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.ABCSMCOutput" href="#GpABC.ABCSMCOutput"><code>GpABC.ABCSMCOutput</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">ABCSMCOutput</code></pre><p>A container for the output of a rejection-ABC computation.</p><p><strong>Fields</strong></p><ul><li><code>n_params::Int64</code>: The number of parameters to be estimated.</li><li><code>n_accepted::Int64</code>: The number of accepted parameter vectors (particles) in the posterior.</li><li><code>n_tries::Int64</code>: The total number of parameter vectors (particles) that were tried.</li><li><code>threshold_schedule::AbstractArray{Float64}</code>: A set of maximum distances from the summarised model output to summarised observed data for a parameter vector to be included in the posterior. Each distance will be used in a single run of the ABC-SMC algorithm.</li><li><code>population::AbstractArray{Float64,2}</code>: The parameter vectors (particles) in the posterior. Size: (<code>n_accepted</code>, <code>n_params</code>).</li><li><code>distances::AbstractArray{Float64,1}</code>: The distances for each parameter vector (particle) in the posterior to the observed data in summary statistic space. Size: (<code>n_accepted</code>).</li><li><code>weights::StatsBase.Weights</code>: The weight of each parameter vector (particle) in the posterior.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/cadb9b1454bb34fe670c90d263bba63a52f1ec93/src/abc/io.jl#L280-L293">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.SimulatedABCRejection" href="#GpABC.SimulatedABCRejection"><code>GpABC.SimulatedABCRejection</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">SimulatedABCRejection(
    reference_data,
    simulator_function,
    priors,
    threshold,
    n_particles;
    summary_statistic   = &quot;keep_all&quot;,
    distance_function   = Distances.euclidean,
    max_iter            = 10 * n_particles,
    write_progress      = true,
    progress_every      = 1000,
    )</code></pre><p>Run simulation-based rejection ABC algorithm. Particles are sampled from the prior, and the model is simulated for each particle. Only those particles are included in the posterior that have distance between the simulation results and the reference data below the threshold (after taking summary statistics into account).</p><p>See <a href="../overview-abc/#abc-overview-1">ABC Overview</a> for more details.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>reference_data::AbstractArray{Float,2}</code>: Observed data to which the simulated model output will be compared. Array dimensions sould match that of the simulator function result.</li><li><code>simulator_function::Function</code>: A function that takes a parameter vector as an argument and outputs model results.</li><li><code>priors::AbstractArray{ContinuousUnivariateDistribution,1}</code>: Continuous univariate distributions, from which candidate parameters will be sampled. Array size should match the number of parameters.</li><li><code>threshold::Float</code>: The <span>$\varepsilon$</span> threshold to be used in ABC algorithm. Only those particles that produce simulated results that are within this threshold from the reference data are included into the posterior.</li><li><code>n_particles::Int</code>: The number of parameter vectors (particles) that will be included in the posterior.</li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>summary_statistic::Union{String,AbstractArray{String,1},Function}</code>: Summary statistics that will be applied to the data before computing the distances. Defaults to <code>keep_all</code>. See <a href="../summary_stats/#summary_stats-1">detailed documentation of summary statistics</a>.</li><li><code>distance_function::Function</code>: A function that will be used to compute the distance between the summary statistic of the simulated data and that of reference data. Defaults to <code>Distances.euclidean</code>.</li><li><code>max_iter::Int</code>: The maximum number of simulations that will be run. The default is <code>1000 * n_particles</code>.</li><li><code>write_progress::Bool</code>: Whether algorithm progress should be printed on standard output. Defaults to <code>true</code>.</li><li><code>progress_every::Int</code>: Number of iterations at which to print progress. Defaults to 1000.</li></ul><p><strong>Returns</strong></p><p>An <a href="#GpABC.ABCRejectionOutput"><code>ABCRejectionOutput</code></a> object.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/cadb9b1454bb34fe670c90d263bba63a52f1ec93/src/abc/simulation.jl#L1-L37">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.EmulatedABCRejection" href="#GpABC.EmulatedABCRejection"><code>GpABC.EmulatedABCRejection</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">EmulatedABCRejection(
    reference_data,
    simulator_function,
    priors,
    threshold,
    n_particles,
    n_design_points;
    summary_statistic               = &quot;keep_all&quot;,
    distance_function               = Distances.euclidean,
    batch_size                      = 10*n_particles,
    max_iter                        = 1000,
    emulator_training               = DefaultEmulatorTraining(),
    emulated_particle_selection     = MeanEmulatedParticleSelection(),
    write_progress                  = true,
    progress_every                  = 1000,
    )</code></pre><p>Run emulation-based rejection ABC algorithm. Model simulation results are used to train the emulator, which is then used to get the approximated distance for each particle. The rest of the workflow is similar to <a href="#GpABC.SimulatedABCRejection"><code>SimulatedABCRejection</code></a>.</p><p>See <a href="../overview-abc/#abc-overview-1">ABC Overview</a> for more details.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>reference_data::AbstractArray{Float,2}</code>: Observed data to which the simulated model output will be compared. Array dimensions sould match that of the simulator function result.</li><li><code>simulator_function::Function</code>: A function that takes a parameter vector as an argument and outputs model results.</li><li><code>priors::AbstractArray{ContinuousUnivariateDistribution,1}</code>: Continuous univariate distributions, from which candidate parameters will be sampled. Array size should match the number of parameters.</li><li><code>threshold::Float</code>: The <span>$\varepsilon$</span> threshold to be used in ABC algorithm. Only those particles that produce emulated results that are within this threshold from the reference data are included into the posterior.</li><li><code>n_particles::Int</code>: The number of parameter vectors (particles) that will be included in the posterior.</li><li><code>n_design_points::Int</code>: The number of design particles that will be simulated to traing the emulator.</li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>summary_statistic::Union{String,AbstractArray{String,1},Function}</code>: Summary statistics that will be applied to the data before computing the distances. Defaults to <code>keep_all</code>. See <a href="../summary_stats/#summary_stats-1">detailed documentation of summary statistics</a>.</li><li><code>distance_function::Function</code>: A function that will be used to compute the distance between the summary statistic of the simulated data and that of reference data. Defaults to <code>Distances.euclidean</code>.</li><li><code>batch_size::Int</code>: The number of particles that will be emulated on each iteration. Defaults to <code>1000 * n_particles</code>.</li><li><code>max_iter::Int</code>: The maximum number of emulations that will be run. Defaults to 1000.</li><li><code>emulator_training&lt;:AbstractEmulatorTraining</code>: This determines how the emulator will be trained. See <a href="../ref-abc-advanced/#GpABC.AbstractEmulatorTraining"><code>AbstractEmulatorTraining</code></a> for more details.</li><li><code>emulated_particle_selection&lt;:AbstractEmulatedParticleSelection</code>: This determines how the particles that will be added to the posterior are selected after each emulation run. See <a href="../ref-abc-advanced/#GpABC.AbstractEmulatedParticleSelection"><code>AbstractEmulatedParticleSelection</code></a> for details. Defaults to <a href="../ref-abc-advanced/#GpABC.MeanEmulatedParticleSelection"><code>MeanEmulatedParticleSelection</code></a>.</li><li><code>write_progress::Bool</code>: Whether algorithm progress should be printed on standard output. Defaults to <code>true</code>.</li></ul><p><strong>Returns</strong></p><p>An <a href="#GpABC.ABCRejectionOutput"><code>ABCRejectionOutput</code></a> object.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/cadb9b1454bb34fe670c90d263bba63a52f1ec93/src/abc/emulation.jl#L1-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.SimulatedABCSMC" href="#GpABC.SimulatedABCSMC"><code>GpABC.SimulatedABCSMC</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">SimulatedABCSMC(
    reference_data,
    simulator_function,
    priors,
    threshold_schedule,
    n_particles;
    summary_statistic   = &quot;keep_all&quot;,
    distance_function   = Distances.euclidean,
    max_iter            = 10 * n_particles,
    write_progress      = true,
    progress_every      = 1000,
    )</code></pre><p>Run a simulation-based ABC-SMC algorithm. This is similar to <a href="#GpABC.SimulatedABCRejection"><code>SimulatedABCRejection</code></a>, the main difference being that an array of thresholds is provided instead of a single threshold. It is assumed that thresholds are sorted in decreasing order.</p><p>A simulation based ABC iteration is executed for each threshold. For the first threshold, the provided prior is used. For each subsequent threshold, the posterior from the previous iteration is used as a prior.</p><p>See <a href="../overview-abc/#abc-overview-1">ABC Overview</a> for more details.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>reference_data::AbstractArray{Float,2}</code>: Observed data to which the simulated model output will be compared. Array dimensions sould match that of the simulator function result.</li><li><code>simulator_function::Function</code>: A function that takes a parameter vector as an argument and outputs model results.</li><li><code>priors::AbstractArray{ContinuousUnivariateDistribution,1}</code>: Continuous univariate distributions, from which candidate parameters will be sampled during the first iteration. Array size should match the number of parameters.</li><li><code>threshold_schedule::AbstractArray{Float,1}</code>: The threshold schedule to be used in ABC algorithm. An ABC iteration is executed for each threshold. It is assumed that thresholds are sorted in decreasing order.</li><li><code>n_particles::Int</code>: The number of parameter vectors (particles) that will be included in the posterior.</li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>summary_statistic::Union{String,AbstractArray{String,1},Function}</code>: Summary statistics that will be applied to the data before computing the distances. Defaults to <code>keep_all</code>. See <a href="../summary_stats/#summary_stats-1">detailed documentation of summary statistics</a>.</li><li><code>distance_function::Function</code>: A function that will be used to compute the distance between the summary statistic of the simulated data and that of reference data. Defaults to <code>Distances.euclidean</code>.</li><li><code>max_iter::Int</code>: The maximum number of simulations that will be run. The default is <code>1000 * n_particles</code>.</li><li><code>write_progress::Bool</code>: Whether algorithm progress should be printed on standard output. Defaults to <code>true</code>.</li><li><code>progress_every::Int</code>: Number of iterations at which to print progress. Defaults to 1000.</li></ul><p><strong>Returns</strong></p><p>An <a href="#GpABC.ABCSMCOutput"><code>ABCSMCOutput</code></a> object.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/cadb9b1454bb34fe670c90d263bba63a52f1ec93/src/abc/simulation.jl#L65-L104">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="GpABC.EmulatedABCSMC" href="#GpABC.EmulatedABCSMC"><code>GpABC.EmulatedABCSMC</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">EmulatedABCSMC(
    reference_data,
    simulator_function,
    priors,
    threshold_schedule,
    n_particles,
    n_design_points;
    summary_statistic               = &quot;keep_all&quot;,
    distance_function               = Distances.euclidean,
    batch_size                      = 10*n_particles,
    max_iter                        = 1000,
    emulator_training               = DefaultEmulatorTraining(),
    emulator_retraining             = NoopRetraining(),
    emulated_particle_selection     = MeanEmulatedParticleSelection(),
    write_progress                  = true,
    progress_every                  = 1000,
    )</code></pre><p>Run emulation-based ABC-SMC algorithm. This is similar to <a href="#GpABC.EmulatedABCRejection"><code>EmulatedABCRejection</code></a>, the main difference being that an array of thresholds is provided instead of a single threshold. It is assumed that thresholds are sorted in decreasing order.</p><p>An emulation based ABC iteration is executed for each threshold. For the first threshold, the provided prior is used. For each subsequent threshold, the posterior from the previous iteration is used as a prior.</p><p>See <a href="../overview-abc/#abc-overview-1">ABC Overview</a> for more details.</p><p><strong>Mandatory arguments</strong></p><ul><li><code>reference_data::AbstractArray{Float,2}</code>: Observed data to which the simulated model output will be compared. Array dimensions sould match that of the simulator function result.</li><li><code>simulator_function::Function</code>: A function that takes a parameter vector as an argument and outputs model results.</li><li><code>priors::AbstractArray{ContinuousUnivariateDistribution,1}</code>: Continuous univariate distributions, from which candidate parameters will be sampled during the first iteration. Array size should match the number of parameters.</li><li><code>threshold_schedule::AbstractArray{Float,1}</code>: The threshold schedule to be used in ABC algorithm. An ABC iteration is executed for each threshold. It is assumed that thresholds are sorted in decreasing order.</li><li><code>n_particles::Int</code>: The number of parameter vectors (particles) that will be included in the posterior.</li><li><code>n_design_points::Int</code>: The number of design particles that will be simulated to traing the emulator.</li></ul><p><strong>Optional keyword arguments</strong></p><ul><li><code>summary_statistic::Union{String,AbstractArray{String,1},Function}</code>: Summary statistics that will be applied to the data before computing the distances. Defaults to <code>keep_all</code>. See <a href="../summary_stats/#summary_stats-1">detailed documentation of summary statistics</a>.</li><li><code>distance_function::Function</code>: A function that will be used to compute the distance between the summary statistic of the simulated data and that of reference data. Defaults to <code>Distances.euclidean</code>.</li><li><code>batch_size::Int</code>: The number of particles that will be emulated on each iteration. Defaults to <code>1000 * n_particles</code>.</li><li><code>max_iter::Int</code>: The maximum number of emulations that will be run. Defaults to 1000.</li><li><code>emulator_training&lt;:AbstractEmulatorTraining</code>: This determines how the emulator will be trained for each iteration. See <a href="../ref-abc-advanced/#GpABC.AbstractEmulatorTraining"><code>AbstractEmulatorTraining</code></a> for more details.</li><li><code>emulator_retraining&lt;:AbstractEmulatorRetraining</code>: This is used to specify parameters of additional emulator retraining that can be done for each iteration. By default this retraining is switched off (<a href="../ref-abc-advanced/#GpABC.NoopRetraining"><code>NoopRetraining</code></a>). See [<code>AbstractEmulatorRetraining</code>] for more details.</li><li><code>emulated_particle_selection&lt;:AbstractEmulatedParticleSelection</code>: This determines how the particles that will be added to the posterior are selected after each emulation run. See <a href="../ref-abc-advanced/#GpABC.AbstractEmulatedParticleSelection"><code>AbstractEmulatedParticleSelection</code></a> for details. Defaults to <a href="../ref-abc-advanced/#GpABC.MeanEmulatedParticleSelection"><code>MeanEmulatedParticleSelection</code></a>.</li><li><code>write_progress::Bool</code>: Whether algorithm progress should be printed on standard output. Defaults to <code>true</code>.</li></ul><p><strong>Returns</strong></p><p>An <a href="#GpABC.ABCSMCOutput"><code>ABCSMCOutput</code></a> object.</p></div></div><a class="source-link" target="_blank" href="https://github.com/tanhevg/GpABC.jl/blob/cadb9b1454bb34fe670c90d263bba63a52f1ec93/src/abc/emulation.jl#L79-L127">source</a></section><footer><hr/><a class="previous" href="../example-gp/"><span class="direction">Previous</span><span class="title">Gaussian Processes</span></a><a class="next" href="../ref-abc-advanced/"><span class="direction">Next</span><span class="title">ABC Advanced</span></a></footer></article></body></html>
